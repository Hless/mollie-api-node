// Generated by CoffeeScript 1.8.0

/*
  Example 13 - How to list all Customer Payments.
 */

(function() {
  var example, mollie;

  mollie = require("./mollie");

  example = (function() {
    function example(request, response) {

      /*
      			Retrieve the last created customer for this example.
      			If no customers are created yet, run example 11.
       */
      mollie.customers.all((function(_this) {
        return function(customers) {

          /*
          				Retrieve the last created customer for this example.
          				If no customers are created yet, run example 11.
           */
          var customer;
          customer = customers[0];

          /*
          			  Get the all payments for this API key ordered by newest.
           */
          return mollie.customers_payments.withParent(customer).all(function(payments) {
            var payment, _i, _len;
            if (payments.error) {
              console.error(payments.error);
              return response.end();
            }
            response.writeHead(200, {
              "Content-Type": "text/html; charset=utf-8"
            });
            for (_i = 0, _len = payments.length; _i < _len; _i++) {
              payment = payments[_i];
              response.write("â‚¬ " + payment.amount + ", status: " + payment.status + " <br>");
            }
            return response.end();
          });
        };
      })(this));
    }

    return example;

  })();

  module.exports = example;

}).call(this);
